<div class="row">
  <div class="col-md-3">
  </div>
  <div class="col-md-6 position">
    <app-notificacoes></app-notificacoes>
    <h2 class="my-4">Bem-Vindo, {{nameUser}}</h2>
    


    <ul class="nav nav-tabs navigator">
      <li class="nav-item">
        <a class="nav-link active" (click)="getBookKindle()">Kindle</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" (click)="getBookFisics()">Fisícos</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" (click)="getBookPdf()">Pdf</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" (click)="getBookTeses()">Teses</a>
      </li>
    </ul>

    <div class="w-100 mt-3 d-flex justify-content-between">
      <div class="w-50">
        <h2 class="my-3">Seus Livros</h2>
      </div>
      <div class="search-box">
        <input #mySearch name="filtro" type="text" class="search-text" placeholder="Pesquisar..." [(ngModel)]="filtro"
          id="filtro">
        <a class="search-btn" (click)="getBookByTitulo(filtro)">
          <img src="../../../assets/icons/search1.png" alt="" class="loupe-blue">
          <img src="../../../assets/icons/search.png" alt="" class="loupe-white">
        </a>
      </div>
      <div class="filter">
        <img src="../../../assets/icons/filter.png" alt="" height="25px">
      </div>
    </div>

    <div class="tab-content " id="nav-tabContent">
      <div class="tab-pane fade show active" id="todasPostagens" role="tabpanel"
        aria-labelledby="nav-todasPostagens-tab">
        <div class="d-block">
          <div class="d-flex flex-wrap container">
            <div class="card book mx-2 mt-4" style="width: 14vw;" *ngFor="let book of bookShelf$ |async">

              <!-- =======================BOTÃO DELETAR============================ -->
              <button class="btn btn-delete align-text-bottom" (click)="deleteBookById(book.id, book.tipo_livro)"></button>



              <div class="image">
                <img src="{{book.foto}}" class="card-img-top" alt="...">
              </div>
              <div class="card-body W-100">
                <div class="d-flex justify-content-between">

                  <p class="read" *ngIf="book.lido==true">lido</p>
                  <p class="no-read" *ngIf="book.lido==false">não lido</p>


                  <button class="btn btn-outline-primary btn-edit" data-bs-toggle="modal" data-bs-target="#exampleModal"
                    (click)="setPutByBookId(book.id, book.tipo_livro)">
                    <img src="../../../assets/icons/ferramenta-lapis.png" alt="" height="17px" data-bs-toggle="modal"
                      data-bs-target="#exampleModal">

                  </button>


                </div>

               
                  <h6 class="card-title">{{book.titulo}}</h6>

              
                <p class="card-text">{{book.autor}}</p>
                <a (click)="getBookById(book.id)" class="btn btn-primary btn-more w-100">Ver mais</a>



              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade show active" id="todasPostagens" role="tabpanel"
        aria-labelledby="nav-todasPostagens-tab">

      </div>
      <div class="tab-pane fade show active" id="todasPostagens" role="tabpanel"
        aria-labelledby="nav-todasPostagens-tab">

      </div>
    </div>
  </div>

  <div class="col-md-3 position sobre" *ngIf="bookById$ |async as book">

    <h3 class="text-center my-4">Sobre o Livro</h3>
    <div class="image-about text-center">
      <img src="{{book.foto}}" class="card-img-top" alt="...">
    </div>
    <h4 class="text-center mt-4 mb-2 text-white">{{book.titulo}}</h4>
    <p class="text-center text-white">{{book.autor}}</p>
    <div class="ficha">
      <h6 class="mt-4 mb-3 text-white">Subtitulo: {{book.subtitulo}}</h6>
      <h6 class="mb-3 text-white">Cidade: {{book.cidade}}</h6>
      <h6 class="mb-3 text-white">Editora: {{book.editora}}</h6>
      <h6 class="mb-3 text-white">Lido: {{book.lido}}</h6>
      <h6 class="mb-3 text-white">Gênero: {{book.genero}}</h6>
      <h6 class="mb-3 text-white">Subgenero: {{book.subgenero}}</h6>
      <h6 class="mb-3 text-white">Idioma: {{book.idioma}}</h6>
      <div class="d-flex w-100 justify-content-between">
        <div class="info-number">
          <h6 class="text-white text-center">Edição:</h6>
          <p class="text-white text-center">{{book.edicao}}</p>
        </div>

        <div class="info-number">
          <h6 class="text-white text-center">Ano:</h6>
          <p class="text-white text-center">{{book.ano}}</p>
        </div>
        <div class="info-number">
          <h6 class="text-white text-center">Nacional ?</h6>
          <p class="text-white text-center">{{book.nacional}}</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- =====================MODAL DELETAR================================= -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true"
  *ngFor="let book of bookShelf$ |async">
  <div class="modal-dialog modal-delete">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <h4 class="text-center">Deseja mesmo excluir esse livro?</h4>
        <div class="d-flex w-100 mt-3">
          <button class="btn btn-outline-secondary w-50 mx-3" data-bs-dismiss="modal" aria-label="Close"
            type="button">Cancelar</button>
          <button class="btn btn btn-danger w-50" (click)="deleteBookById(book.id, book.tipo_livro)"
            data-bs-dismiss="modal" aria-label="Close" type="button">Excluir</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- =====================MODAL EDITAR================================= -->
<div class="modal fade" id="exampleModal" *ngIf="put$ as book" tabindex="-1" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-edit modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Editar Livro</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form action="" method="post" #frm="ngForm" (ngSubmit)="putBook(frm, book.tipo_livro)" class="mt-4">
          <div>
            <div class="d-flex">
              <label for="staticEmail" class="col-sm-2 col-form-label">Titulo:</label>
              <input id="titulo" name="titulo" type="text" placeholder="titulo" class="w-100" [(ngModel)]="book.titulo"
                class="w-100 form-control" />
            </div>
          </div>
          <div class="mt-3 d-flex">
            <label for="staticEmail" class="col-sm-2 col-form-label">Subtitulo:</label>
            <input id="subtitulo" name="subtitulo" type="text" placeholder="subtitulo" [(ngModel)]="book.subtitulo"
              class="w-100 form-control" />
          </div>
          <div class="mt-3 d-flex">
            <label for="staticEmail" class="col-sm-2 col-form-label">Autor:</label>
            <input id="autor" name="autor" type="text" placeholder="autor" [(ngModel)]="book.autor"
              class="w-100 form-control" />
          </div>
          <div class="mt-3 d-flex">
            <label for="staticEmail" class="col-sm-2 col-form-label">Link da foto:</label>
            <input id="foto" name="foto" type="text" placeholder="link foto" [(ngModel)]="book.foto"
              class="w-100 form-control" />
          </div>
          <div class="d-flex w-100 mt-3">
            <label for="staticEmail" class="col-sm-2 col-form-label">Ano:</label>
            <input id="ano" name="ano" type="text" placeholder="ano" class="w-100 form-control me-3"
              [(ngModel)]="book.ano" />
            <label for="staticEmail" class="col-sm-1 col-form-label">Genero:</label>
            <input id="genero" name="genero" type="text" placeholder="genero" class="w-100 form-control me-3"
              [(ngModel)]="book.genero" />
            <label for="staticEmail" class="col-sm-2 col-form-label">Subgenero:</label>
            <input id="subgenero" name="subgenero" type="text" placeholder="subgenero" class="w-100 form-control"
              [(ngModel)]="book.subgenero" />
          </div>
          <div class="d-flex w-100 mt-3">
            <label for="staticEmail" class="col-sm-2 col-form-label">Idioma:</label>
            <input id="idioma" name="idioma" type="text" placeholder="idioma" [(ngModel)]="book.idioma"
              class="w-100 form-control me-3" />
            <label for="staticEmail" class="col-sm-2 col-form-label">Cidade:</label>
            <input id="cidade" name="cidade" type="text" placeholder="cidade" [(ngModel)]="book.cidade"
              class="w-100 form-control " />
          </div>

          <div class="d-flex w-100 mt-3">
            <label for="staticEmail" class="col-sm-2 col-form-label">Já li?</label>
            <input id="lido" name="lido" type="text" placeholder="Já li?" [(ngModel)]="book.lido"
              class="w-100 form-control me-3" />
            <label for="staticEmail" class="col-sm-2 col-form-label">Livro nacional?</label>
            <input id="nacional" name="nacional" type="text" placeholder="livro nacional?" [(ngModel)]="book.nacional"
              class="w-100 form-control" />
          </div>




          <div *ngIf="book.tipo_livro != 'teses' ">
            <div class="d-flex w-100 mt-3">
              <label for="staticEmail" class="col-sm-2 col-form-label">Cidade:</label>
              <input id="edicao" name="edicao" type="text" placeholder="edicao" class="w-100 form-control me-3"
                [(ngModel)]="book.edicao" />
              <label for="staticEmail" class="col-sm-2 col-form-label">Editora:</label>
              <input id="editora" name="editora" type="text" placeholder="editora" class="w-100 form-control"
                [(ngModel)]="book.editora" />
            </div>
          </div>

          <div *ngIf="book.tipo_livro == 'kindle' || 'pdf' ">
            <div class="d-flex w-100 mt-3">
              <label for="staticEmail" class="col-sm-2 col-form-label">Tenho Fisico:</label>
              <input id="fisico" name="fisico" type="text" placeholder="tenho fisico?" class="w-100 form-control"
                [(ngModel)]="book.fisico" />
            </div>
          </div>

          <div *ngIf="book.tipo_livro == 'pdf' || 'teses'">
            <div class="d-flex w-100 mt-3">
              <label for="staticEmail" class="col-sm-2 col-form-label">Cidade:</label>
              <input id="pasta" name="pasta" type="text" placeholder="pasta" class="w-100 form-control"
                [(ngModel)]="book.pasta" />
            </div>
          </div>

          <div *ngIf="book.tipo_livro == 'pdf'">
            <label for="staticEmail" class="col-sm-2 col-form-label">Pasta:</label>
            <input id="kindle" name="kindle" type="text" placeholder="tenho kindle?" class="w-100 form-control mt-3"
              [(ngModel)]="book.kindle" />
          </div>

          <div *ngIf="book.tipo_livro == 'teses'">
            <div class="mt-3">
              <label for="staticEmail" class="col-sm-2 col-form-label">Cidade:</label>
              <input id="instituicao" name="instituicao" type="text" class="w-100 form-control "
                placeholder="instituição" [(ngModel)]="book.instituicao" />
            </div>
            <div class="mt-3">
              <label for="staticEmail" class="col-sm-2 col-form-label">Cidade:</label>
              <input id="tipo" name="tipo" type="text" placeholder="tipo" class="w-100 form-control"
                [(ngModel)]="book.tipo" />
            </div>
          </div>
          <div class="d-flex w-100 justify-content-between mt-5">
            <button type="submit" class="btn btn-outline-secondary w-25 mt-3"  data-bs-dismiss="modal" aria-label="Close">Cancelar</button>
            <button type="submit" class="btn btn-success w-25 mt-3">Salvar Alteração</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>